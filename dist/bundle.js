let idleTime=0;$(document).ready(function(){$(logDate).datepicker({dateFormat:"yy/mm/dd"});let o=function(o,e){return{API_BASE:"http://localhost:3000/api/",setAuthHeader:function(e){window.localStorage.setItem("sessionToken",e),o.ajaxSetup({headers:{Authorization:e}})}}}(jQuery);$(".nav-tabs a[data-toggle=tab]").on("click",function(o){let e=window.localStorage.getItem("sessionToken");if($(this).hasClass("disabled")&&!e)return o.preventDefault(),!1;e||"loginout"==$(this).attr("id")||alert("You must login first")}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){let t=$(e.target).attr("href");"#log"===t&&o.log.setDefinitions(),"#updateLog"===t&&o.log.setDefinitions(),"#history"===t&&o.log.getChart()}),$(document).on("keypress",function(o){13===o.which&&($(signupModal).is(":visible")&&$(signup).trigger("click"),$(loginModal).is(":visible")&&$(login).trigger("click"))});let e=window.localStorage.getItem("sessionToken");e?(o.setAuthHeader(e),$(homeNav).click()):$(loginout).click(),window.WorkoutLog=o}),$(function(){$.extend(WorkoutLog,{definition:{userDefinitions:[],create:function(){let o={definition:{desc:$(defDescription).val(),type:$(defLogtype).val()}};$.ajax({type:"POST",url:WorkoutLog.API_BASE+"definition",data:JSON.stringify(o),contentType:"application/json"}).done(function(o){WorkoutLog.definition.userDefinitions.push(o.definition),$(defDescription).val(""),$(defLogtype).val(""),$('a[href="#log"]').tab("show")})},checkForm:function(){""!=$(defDescription).val()?WorkoutLog.definition.create():alert("Please fill out all fields")},fetchAll:function(){$.ajax({type:"GET",url:WorkoutLog.API_BASE+"definition",headers:{authorization:window.localStorage.getItem("sessionToken")}}).done(function(o){WorkoutLog.definition.userDefinitions=o}).fail(function(o){console.log(o)})}}}),$(defSave).on("click",WorkoutLog.definition.checkForm),window.localStorage.getItem("sessionToken")&&WorkoutLog.definition.fetchAll()}),$(function(){$.extend(WorkoutLog,{log:{workouts:[],setDefinitions:function(){let o=WorkoutLog.definition.userDefinitions,e=o.length,t="";for(let a=0;a<e;a++)t+="<option value='"+o[a].id+"'>"+o[a].description+"</option>";$(logDefinition).children().remove(),$(logDefinition).append(t),$(updateDefinition).children().remove(),$(updateDefinition).append(t)},setHistory:function(o){let e=o,t=o.length,a="";for(let o=0;o<t;o++)a+="<li class='list-group-item' style='height: auto;'>"+e[o].def+", "+e[o].date+" - "+e[o].time+" minutes<div style='float: right'><a style='margin-left: 30px !important; height: 100%;' id='"+e[o].id+"' class='update logHistoryLink'><strong>U</strong></a><a id='"+e[o].id+"' class='remove logHistoryLink'><strong>X</strong></a></div></li>";$(historyList).children().remove(),$(historyList).append(a)},checkForm:function(){""!=$(logDescription).val()&&""!=$(logResult).val()?WorkoutLog.log.create():alert("Please fill out all fields")},create:function(){let o={log:{desc:$(logDescription).val(),result:$(logResult).val(),date:$(logDate).val(),def:$("#logDefinition option:selected").text()}};$.ajax({type:"POST",url:WorkoutLog.API_BASE+"log",data:JSON.stringify(o),contentType:"application/json"}).done(function(o){WorkoutLog.log.workouts.push(o),$(logDescription).val(""),$(logResult).val(""),$(logDate).val("")})},getWorkout:function(){let o={id:$(this).attr("id")};logID=o.id;let e={log:o};$.ajax({type:"GET",url:WorkoutLog.API_BASE+"log/"+logID,data:JSON.stringify(e),contentType:"application/json"}).done(function(o){$('a[href="#updateLog"]').tab("show"),$(updateResult).val(o.result),$(updateDescription).val(o.description),$(updateID).val(o.id),$(updateLogDate).val(o.date)})},getChart:function(){if(WorkoutLog.log.workouts.length<3)$(chartHeader).html("Please enter more logs to see a chart of data");else{$(chartHeader).html("Progression of time spent running");let o=document.getElementById("runningtimeChartTab").getContext("2d"),e=[];for(let o of WorkoutLog.log.workouts){let t=o.result,a=o.id,l=o.def,i=o.date.replace(/\D/g,"");e.push({time:t,id:a,def:l,lengthDateOrder:i})}e.sort(function(o,e){return parseFloat(o.lengthDateOrder)-parseFloat(e.lengthDateOrder)});let t=e.map(function(o){return o.time}),a=[];for(let o of WorkoutLog.log.workouts){let e=o.date,t=o.date.replace(/\D/g,"");a.push({date:e,dateOrder:t})}a.sort(function(o,e){return parseFloat(o.dateOrder)-parseFloat(e.dateOrder)});let l=a.map(function(o){return o.date}),i=[];for(let o in a){let t={};Object.assign(t,a[o],e[o]),i.push(t)}WorkoutLog.log.setHistory(i);new Chart(o,{type:"bar",data:{labels:l,datasets:[{label:"Time spent running (minutes)",data:t,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}},updateWorkout:function(){let o={id:$(updateID).val(),desc:$(updateDescription).val(),result:$(updateResult).val(),date:$(updateLogDate).val(),def:$("#updateDefinition option:selected").text()};for(var e=0;e<WorkoutLog.log.workouts.length;e++)WorkoutLog.log.workouts[e].id==o.id&&WorkoutLog.log.workouts.splice(e,1);WorkoutLog.log.workouts.push(o);let t={log:o};$.ajax({type:"PUT",url:WorkoutLog.API_BASE+"log",data:JSON.stringify(t),contentType:"application/json"}).done(function(o){$(updateDescription).val(""),$(updateResult).val(""),$('a[href="#history"]').tab("show")})},delete:function(){let o={id:$(this).attr("id")},e={log:o},t=$.ajax({type:"DELETE",url:WorkoutLog.API_BASE+"log",data:JSON.stringify(e),contentType:"application/json"});$(this).closest("li").remove();for(let e=0;e<WorkoutLog.log.workouts.length;e++)(WorkoutLog.log.workouts[e].id=o.id)&&WorkoutLog.log.workouts.splice(e,1);t.fail(function(){console.log("nope, you didn't delete it, an error occurred")})},fetchAll:function(){$.ajax({type:"GET",url:WorkoutLog.API_BASE+"log",headers:{authorization:window.localStorage.getItem("sessionToken")}}).done(function(o){WorkoutLog.log.workouts=o}).fail(function(o){console.log(o)})}}}),$(logSave).on("click",WorkoutLog.log.checkForm),WorkoutLog.log.getChart(),$(historyList).on("click",".remove",WorkoutLog.log.delete),$(logUpdate).on("click",WorkoutLog.log.updateWorkout),$(historyList).on("click",".update",WorkoutLog.log.getWorkout),$(history).on("click").tab("show"),window.localStorage.getItem("sessionToken")&&WorkoutLog.log.fetchAll()}),$(function(){$.extend(WorkoutLog,{checkPassword:function(){$(su_password).val()!==$(su_confirmpassword).val()?alert("Passwords do not match"):WorkoutLog.signup()},checkForm:function(){""!=$(su_username).val()&&""!=$(su_confirmpassword).val()&&""!=$(su_password).val()&&""!=$(su_fullname).val()&&""!=$(su_summary).val()&&""!=$(su_age).val()&&""!=$(su_gender).val()?WorkoutLog.checkPassword():alert("Please fill out all fields")},signup:function(){let o={user:{username:$(su_username).val(),password:$(su_password).val(),fullname:$(su_fullname).val(),summary:$(su_summary).val(),age:$(su_age).val(),gender:$(su_gender).val()}};$.ajax({type:"POST",url:WorkoutLog.API_BASE+"user",data:JSON.stringify(o),contentType:"application/json"}).done(function(o){o.sessionToken&&(WorkoutLog.setAuthHeader(o.sessionToken),WorkoutLog.definition.fetchAll(),WorkoutLog.log.fetchAll()),$(signupModal).modal("hide"),$(".disabled").removeClass("disabled"),$(loginout).text("Logout"),$('a[href="#home"]').tab("show"),$(su_username).val(""),$(su_password).val(""),alert("You have successfully signed up! Please login to continue"),WorkoutLog.loginout()}).fail(function(){$(su_error).text("There was an issue with sign up").show()}).always(function(){})},login:function(){let o=$(li_username).val(),e=$(li_password).val();user={user:{username:o,password:e}},$.ajax({type:"POST",url:WorkoutLog.API_BASE+"login",data:JSON.stringify(user),contentType:"application/json"}).done(function(o){o.sessionToken&&(WorkoutLog.setAuthHeader(o.sessionToken),WorkoutLog.definition.fetchAll(),WorkoutLog.log.fetchAll()),user=o.user,WorkoutLog.makeNavBar(),$(loginModal).modal("hide"),$(loginout).text("Logout"),$(".invisible").removeClass("invisible"),localStorage.setItem("profile",JSON.stringify(o.user)),$('a[href="#home"]').tab("show"),$("loginPage").tab("hide"),document.getElementById("home").className="tab-pane active",$(homeNav).click(),WorkoutLog.profileInformation(o.user),alert("You have successfully logged in!"),window.location.reload(!0)}).fail(function(){$(li_error).text("There was an issue with log in").show()})},makeNavBar:function(){$(homeNav).html("Home"),$(defineNav).html("Define"),$(logNav).html("Log"),$(historyNav).html("View History"),$(".invisible").removeClass("invisible")},loginout:function(){window.localStorage.getItem("sessionToken")&&(window.localStorage.clear(),window.location.reload(!0))},profileInformation:function(o){let e=o,t="<li><a href='#userTab' data-toggle='tab' class=''>Welcome "+e.fullname+"!</a></li>";$(mainNavigation).append(t),$(profileUsername).html(e.username),$(profileUpdater).html("Click here to update profile"),$(profileFullname).html(e.fullname),$(profileSummary).html(e.summary),$(profileAge).html(e.age),$(profileGender).html(e.gender)},fillUpdateProfile:function(o){$(update_username).val(o.username),$(update_password).val(),$(update_confirmpassword).val(),$(update_fullname).val(o.fullname),$(update_summary).val(o.summary),$(update_age).val(o.age),$(update_gender).val(o.gender)},updateProfile:function(){if($(update_password).val()==$(update_confirmpassword).val())if(""!=$(update_username).val()&&""!=$(update_confirmpassword).val()&&""!=$(update_password).val()&&""!=$(update_fullname).val()&&""!=$(update_summary).val()&&""!=$(update_age).val()&&""!=$(update_gender).val()&&typeof $(update_age)==integer){let e=$(update_username).val(),t=$(update_password).val(),a=$(update_fullname).val(),l=$(update_summary).val(),i=$(update_age).val(),n=$(update_gender).val(),r={user:{id:o.id,username:e,password:t,fullname:a,summary:l,age:i,gender:n}};$.ajax({type:"PUT",url:WorkoutLog.API_BASE+"user",data:JSON.stringify(r),contentType:"application/json"}).done(function(o){alert("You have successfully updated your profile!"),window.location.reload(!0)}).fail(function(o){alert("There was an issue with updating. Please log in and try again")})}else alert("Please fill out all fields and confirm age is a number");else alert("Passwords do not match")}}),$(signup).on("click",WorkoutLog.checkForm);let o=localStorage.profile;0!=localStorage.length&&"object"!=typeof o&&null!==typeof o&&(o=JSON.parse(o),WorkoutLog.profileInformation(o)),$(login).on("click",WorkoutLog.login),$(loginout).on("click",WorkoutLog.loginout),window.localStorage.getItem("sessionToken")&&($(loginout).text("Logout"),WorkoutLog.makeNavBar(),$(".invisible").removeClass("invisible"),document.getElementById("home").className="tab-pane active",document.getElementById("loginPage").className="tab-pane fade"),$(profileUpdater).on("click",function(){WorkoutLog.fillUpdateProfile(o)}),$(updateProfile).on("click",WorkoutLog.updateProfile);setInterval(function(){(idleTime+=1)>30&&window.localStorage.getItem("sessionToken")&&(alert("You have been logged out due to inactivity."),WorkoutLog.loginout())},5e3);$(this).mousemove(function(o){idleTime=0}),$(this).keypress(function(o){idleTime=0})});
//# sourceMappingURL=maps/bundle.js.map
